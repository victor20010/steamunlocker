# steamunlocker
SteamUnlocker — инструмент для разблокировки игр Steam

![Platform](https://img.shields.io/badge/Platform-Windows-blue)

![Language](https://img.shields.io/badge/Language-C%252B%252B-red)

Примечание: если вы хотите внести собственные изменения, можете использовать оригинальное ядро GL с открытым исходным кодом из папки code, либо воспользоваться моей сборкой из раздела releases.

SteamUnlocker — это инструмент на C++, который динамически генерирует DLL и внедряет её в процесс Steam, имитируя наличие определённых игр у пользователя. В основе лежит технология перехвата API, позволяющая изменить механизм проверки лицензий Steam так, чтобы клиент считал, что у пользователя есть выбранные игры.

## Особенности

- **Динамическая генерация DLL:** во время работы, на основе введённых AppID игр, формируется индивидуальная DLL.
- **Инъекция в процесс:** созданная DLL внедряется в процесс Steam для модификации его работы.
- **Управление AppID:** поддерживается добавление нескольких AppID для одновременной разблокировки игр.
- **Автоматизация:** автоматическое завершение работы Steam, внедрение DLL и перезапуск клиента.
- **Очистка временных файлов:** после использования временные файлы удаляются автоматически.

## Техническая реализация

![deepseek_mermaid_20250623_6ca322](https://github.com/user-attachments/assets/910a3e4f-ce5f-4f00-83a9-ee010eff9ac8)

---

## Инструкция по использованию

### Сборка проекта

- Откройте проект в Visual Studio.
- Выберите режим Release x86.
- Соберите исполняемый файл.

### Запуск программы

- Запустите steamunlocker.exe от имени администратора.
- Введите AppID игр, которые хотите разблокировать (по одному на строку).
- Введите 0 для завершения ввода.
- Программа выполнит все последующие шаги автоматически.

### Использование через командную строку (опционально)
```
steamunlocker.exe 730 570 440 # Разблокировать CS:GO, Dota 2, TF2
```

---

## Дисклеймер

⚠️ Этот инструмент предназначен только для образовательных целей  
⚠️ Запрещается использовать для пиратства или иных незаконных целей  
⚠️ Использование может привести к блокировке аккаунта Steam  
⚠️ Поддержите разработчиков — покупайте лицензионные игры  

---

## Технические детали

### Основные компоненты

1. **Шаблон генерации DLL:**
```cpp
const char* DLL_TEMPLATE = R"(
  // Шаблон исходного кода DLL
  
  __declspec(dllexport) int g_appIdCount = %d;
  __declspec(dllexport) int g_appIds[] = {%s};
  
  // Реализация перехвата API...
)";
```

2. **Управление процессом:**

- Поиск и завершение процесса Steam
- Технология инъекции в процесс
- Управление правами доступа

3. **Работа с AppID:**

- Обработка пользовательского ввода
- Управление динамическими массивами
- Сериализация данных

---

## Принцип инъекции

```
sequenceDiagram
    participant UserApp
    participant SteamClient
    participant CustomDLL
    
    UserApp->>CustomDLL: 1. Генерация DLL
    UserApp->>SteamClient: 2. Завершение процесса Steam
    UserApp->>SteamClient: 3. Запуск и инъекция DLL
    SteamClient->>CustomDLL: 4. Загрузка DLL
    SteamClient->>CustomDLL: 5. Вызов IsSubscribedApp
    CustomDLL-->>SteamClient: 6. Возврат изменённого результата проверки лицензии
```

![deepseek_mermaid_20250623_6ad26a](https://github.com/user-attachments/assets/5f1dff8b-0540-4d8c-9408-5fdc7f789c1a)

---

## Оригинальное ядро GL

### Основной принцип

GreenLuma модифицирует механизм проверки AppID в клиенте Steam, заставляя его считать, что пользователь владеет выбранными играми. Для этого используется инъекция DLL с пользовательским кодом в процесс Steam.

### Детали реализации

- **Определение игр:** идентификация через AppID Steam
- **Перехват функций:** изменение вызовов API, отвечающих за проверку собственности на игру
- **Модификация памяти:** изменение данных в памяти клиента Steam во время работы

### Особенности GreenLumaGUI

- Интерфейс на WPF (Windows Presentation Foundation)
- Поиск игр через Steam API
- Создание и управление списком AppID
- Автоматический запуск и инъекция в клиент Steam

#### Рабочий процесс

- Пользователь ищет и выбирает игры через интерфейс
- Программа сохраняет их AppID
- При запуске закрывает Steam, затем запускает модифицированный Steam и внедряет необходимый код
- В изменённом клиенте Steam выбранные игры будут отображаться как "приобретённые"

GreenLumaGUI по сути добавляет удобный графический интерфейс к оригинальному функционалу GreenLuma, упрощая использование для обычных пользователей.

---

## Технические детали изменения памяти

- **Инъекция DLL:**  
  Используются функции Windows API, такие как CreateRemoteThread и LoadLibrary, чтобы внедрить DLL в адресное пространство процесса Steam. Это позволяет выполнять пользовательский код прямо внутри процесса Steam.
- **Перехват API-функций (Hooking):**  
  Изменяются адреса ключевых функций Steam, отвечающих за проверку собственности на игры (например, ISteamApps::BIsSubscribedApp()), с использованием библиотек типа Detours или MinHook.
- **Изменение структур данных в памяти:**  
  Находятся структуры памяти, содержащие список игр и лицензий, и в них добавляются нужные AppID.
- **Патчи во время выполнения:**  
  Перехватываются вызовы проверки и для указанных AppID всегда возвращается "успешно".
- **Обход проверки целостности:**  
  Возможна модификация или отключение механизмов защиты целостности памяти Steam.

Такие техники схожи с игровыми трейнерами и античитами, однако преследуют другие цели. GreenLumaGUI не реализует низкоуровневые изменения напрямую, а предоставляет графический интерфейс для настройки и запуска оригинального инструмента GreenLuma — он и выполняет модификации в памяти.

---

## Реализация перехвата API

- **Поиск адреса функции:**  
  Определяется адрес функции в Steam, отвечающей за проверку собственности на игру (например, ISteamApps::BIsSubscribedApp()), путём анализа бинарного файла клиента.
- **Получение прав на запись в память:**  
  С помощью VirtualProtectEx() изменяются права доступа к нужной области памяти (PAGE_EXECUTE_READWRITE).
- **Замена пролога функции:**  
  В начало функции вставляется JMP-инструкция, которая передаёт управление пользовательской реализации.
- **Реализация альтернативной функции:**  
  Для выбранных AppID всегда возвращается "true" (игра куплена), для остальных случаев возможен вызов оригинальной функции.
- **Trampoline-механизм:**  
  Сохраняются оригинальные инструкции начала функции и создаётся trampoline — участок памяти, обеспечивающий возврат к оригинальному коду при необходимости.

---

## Важные замечания

- Запускать программу нужно с правами администратора
- Антивирус может срабатывать ложно (добавьте в исключения или временно отключите защиту)
- После обновления Steam может потребоваться изменить адреса для инъекции и хука
- После каждого перезапуска Steam инструмент нужно запускать заново

---

## Вклад в проект

- Приветствуются Pull Request’ы:
    1. Сделайте fork репозитория
    2. Создайте ветку для новой функции
    3. Внесите изменения и сделайте commit
    4. Отправьте Pull Request

---

## Лицензия

- Проект распространяется под лицензией GLP3.0
